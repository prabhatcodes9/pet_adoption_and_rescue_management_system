<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PetConnect - Find Your Perfect Pet Companion</title>
    <meta name="description" content="Connect with loving pets in need of homes. Find lost pets, report found animals, and discover your perfect pet companion through our adoption services.">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/lucide/0.263.1/lucide.min.css" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/report_adopt.css') }}">
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <span class="logo-icon">üêæ</span>
                    <h1 class="logo-text">Welcome {{ user.name }} !</h1>
                </div>
                <nav class="header-nav">
                <button class="btn btn-primary" id="openModalBtn" data-testid="button-login">Make a adoption</button>
                <a href="{{ url_for('my_adopt_requests') }}" class="btn btn-primary">My adoption requests</a>
                <a href="{{ url_for('user_dashboard') }}" class="btn btn-primary">Dashboard</a>
                </nav>
            </div>
        </div>
    </header>
    <!-- Report an Adoption -->
     <div id="adoptModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>üêæ Report Pet Adoption</h2>
        <span class="close" id="closeModal">&times;</span>
      </div>

      <form class="modal-form" method="POST" enctype="multipart/form-data" action="{{ url_for('report_adopt') }}">
        <div class="form-group">
          <label for="pet_name">Pet Name</label>
          <input type="text" id="pet_name" name="pet_name" placeholder="Enter pet name" required>
        </div>

        <div class="form-group">
          <label for="pet_type">Pet Type</label>
          <input type="text" id="pet_type" name="pet_type" placeholder="Dog, Cat, etc." required>
        </div>

        <div class="form-group">
          <label for="breed">Breed</label>
          <input type="text" id="breed" name="breed" placeholder="Enter breed" required>
        </div>

        <div class="form-group">
          <label for="age">Age</label>
          <input type="text" id="age" name="age" placeholder="Enter age" required>
        </div>

        <div class="form-group">
          <label for="injury">Injury</label>
          <select id="injury" name="injury" required>
            <option value="Yes">Yes</option>
            <option value="No">No</option>
          </select>
        </div>

        <div class="form-group">
          <label for="gender">Gender</label>
          <select id="gender" name="gender" required>
            <option value="">Select Gender</option>
            <option value="Male">Male</option>
            <option value="Female">Female</option>
            <option value="None">None</option>
          </select>
        </div>

        <div class="form-group">
          <label for="location">Location</label>
          <input type="text" id="location" name="location" placeholder="Enter location" required>
        </div>

        <div class="form-group">
          <label for="description">Description</label>
          <textarea id="description" name="description" placeholder="Describe your pet..." rows="4" required></textarea>
        </div>

        <div class="form-group">
          <label for="contact">Contact Number</label>
          <input type="tel" id="mobile" name="mobile" placeholder="Enter contact number" required>
        </div>

        <div class="form-group">
          <label for="image">Upload Pet Image</label>
          <input type="file" id="image" name="image" accept="uploads/" required>
        </div>

        <div class="modal-footer">
          <button type="submit" class="btn btn-primary btn-full">Submit Report</button>
        </div>
      </form>
    </div>
  </div>

    <!-- Adopt Pets List -->
     <section class="found-pets-section">
        <div class="container">
            <div class="section-header">
                <h2>Pets for Adoption</h2>
            </div>

            <div class="cards-grid">
            {% if adopt_pets %}
              {% for pet in adopt_pets %}
              <div class="pet-card">
                  <div class="pet-image">
                    <img src="{{ url_for('static', filename='uploads/' + pet.image) }}" alt="{{ pet.pet_name }}">
                  </div>

                      <h3>{{ pet.pet_name }} (<span>ID:{{ pet.id }}</span>)</h3>
                      <div class="tags">
                        <span class="tag">{{ pet.pet_type }}</span>
                        <span class="tag">{{ pet.breed }}</span>
                        {% if pet.status == 'pending' %}
                        <span class="tag adoptable">Adoptable</span>
                        {% elif pet.status == 'adopted' %}
                        <span class="tag adopted">Adopted</span>
                        {% endif %}
                      </div>

                      <div class="details">
                        <p><strong>Details:</strong> {{ pet.description }}</p>
                        <p><strong>Location:</strong> {{ pet.location }}</p>
                      </div>

                      <button class="view-btn" onclick="openPetModal('{{ pet.id }}')">View Details</button>
                      {% if pet.user_id != user.id and pet.status != 'adopted' %}
                      <button class="view-btn openRequestModal" data-petid = "{{ pet.id }}" data-petname="{{ pet.pet_name }}">ü§ç Adopt Me
                      </button>
                      {% elif pet.user_id == user.id %}
                      <p style="color: gray; font-style: italic;">(You reported this pet)</p>
                      {% endif %}
              </div>
              <!-- Pet Details Modal -->
              <div class="petmodal" id="petModal-{{ pet.id }}">
                  <div class="pet-modal-content">
                    <button class="close-btn" onclick="closePetModal('{{ pet.id }}')">&times;</button>
                    <h2>{{ pet.pet_name }}</h2>
                      <p><strong>Type:</strong> {{ pet.pet_type }}</p>
                      <p><strong>Breed:</strong> {{ pet.breed }}</p>
                      <p><strong>Age:</strong> {{ pet.age }}</p>
                      <p><strong>Injury:</strong> {{ pet.injury }}</p>
                      <p><strong>Description:</strong> {{ pet.description }}</p>
                      <p><strong>Gender:</strong> {{ pet.gender }}</p>
                      <p><strong>Location:</strong> {{ pet.location }}</p>
                      <p><strong>Contact:</strong> {{ pet.mobile }}</p>
                  </div>
              </div>
              {% endfor %}
            {% else %}
              <p class="no-data">No pets available for adoption.</p>
            {% endif %}
            </div>
        </div>
    </section>
    <!-- Request to Adopt Modal -->
    <div id="requestModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>üêæ Adoption Request for <span id="requestPetName"></span></h2>
                <span class="close" id="closeRequestModal">&times;</span>
            </div>

            <form id="adoptRequestForm" class="modal-form" method="POST">
                <div class="form-group">
                    <label>Your Name</label>
                    <input type="text" name="name" required>
                </div>
                <div class="form-group">
                    <label>Mobile</label>
                    <input type="tel" name="mobile" required>
                </div>
                <div class="form-group">
                    <label for="request_date">Date Request</label>
                    <input type="date" id="request_date" name="request_date" required>
                </div>
                <div class="form-group">
                    <label>Address</label>
                    <input type="text" name="address" required>
                </div>
                <div class="form-group">
                    <label>Why do you want to adopt?</label>
                    <textarea name="reason" rows="4" required></textarea>
                </div>
                <div class="modal-footer">
                    <button type="submit" class="btn btn-primary btn-full">Submit Request</button>
                </div>
            </form>
        </div>
    </div>
      <script>
    const modal = document.getElementById("adoptModal");
    const openBtn = document.getElementById("openModalBtn");
    const closeBtn = document.getElementById("closeModal");

    openBtn.addEventListener("click", () => {
      modal.style.display = "block";
    });

    closeBtn.addEventListener("click", () => {
      modal.style.display = "none";
    });

    window.addEventListener("click", (e) => {
      if (e.target === modal) {
        modal.style.display = "none";
      }
    });
    // Request to adopt modal
        const requestModal = document.getElementById("requestModal");
        const closeRequestModal = document.getElementById("closeRequestModal");
        const openRequestBtns = document.querySelectorAll(".openRequestModal");
        const requestForm = document.getElementById("adoptRequestForm");
        const petNameSpan = document.getElementById("requestPetName");

        openRequestBtns.forEach(btn => {
            btn.addEventListener("click", () => {
                const petId = btn.getAttribute("data-petid");
                const petName = btn.getAttribute("data-petname");
                petNameSpan.textContent = petName;
                requestForm.action = `/adopt_request/${petId}`;
                requestModal.style.display = "block";
            });
        });

        closeRequestModal.addEventListener("click", () => {
            requestModal.style.display = "none";
        });

        window.addEventListener("click", (e) => {
            if (e.target === requestModal) requestModal.style.display = "none";
        });
        function openPetModal(id) {
  document.getElementById('petModal-' + id).style.display = 'flex';
}
function closePetModal(id) {
  document.getElementById('petModal-' + id).style.display = 'none';
}
window.onclick = function(event) {
  document.querySelectorAll('.modal').forEach(modal => {
    if (event.target === modal) {
      modal.style.display = 'none';
    }
  });
}
  </script>
  </body>
</html>